<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>N-Queens Visualizer - SDE Prep</title>
  <link rel="stylesheet" href="../styles.css">
  <style>
    .visualizer-section {
      display: flex;
      flex-direction: row;
      gap: 20px;
      align-items: flex-start;
    }
    .code-display {
      flex: 1;
      background-color: #1e1e1e;
      border-radius: 8px;
      overflow: hidden;
      border: 1px solid #333;
    }
    .lang-tabs {
      display: flex;
      background-color: #252526;
      border-bottom: 1px solid #333;
    }
    .tab-btn {
      background: none;
      border: none;
      color: #888;
      padding: 10px 20px;
      cursor: pointer;
      font-family: inherit;
      font-weight: 600;
    }
    .tab-btn.active {
      color: #fff;
      background-color: #1e1e1e;
      border-top: 2px solid var(--accent-color);
    }
    .code-content {
      padding: 15px;
      margin: 0;
      color: #d4d4d4;
      font-family: 'Consolas', 'Monaco', monospace;
      font-size: 14px;
      line-height: 1.5;
      overflow-x: auto;
    }
    .line {
      display: block;
      padding: 0 5px;
    }
    .line.active {
      background-color: rgba(59, 130, 246, 0.2);
    }
    .board-view {
      flex: 1;
      display: flex;
      justify-content: center;
      padding: 20px;
      background: var(--bg-tertiary);
      border-radius: 8px;
    }
    .chess-grid {
      display: grid;
      grid-template-columns: repeat(4, 60px);
      grid-template-rows: repeat(4, 60px);
      border: 4px solid #5c4033;
    }
    .chess-cell {
      width: 60px;
      height: 60px;
      display: flex;
      justify-content: center;
      align-items: center;
      font-size: 32px;
    }
    .chess-cell.white { background-color: #f0d9b5; }
    .chess-cell.black { background-color: #b58863; }
    .chess-cell.queen { color: #000; text-shadow: 0 0 2px #fff; }
    .chess-cell.checking { box-shadow: inset 0 0 0 4px #ef4444; }
    .chess-cell.placing { box-shadow: inset 0 0 0 4px #22c55e; }
    
    .controls {
      display: flex;
      justify-content: center;
      gap: 15px;
      margin-bottom: 20px;
      align-items: center;
    }
    .status-text { text-align: center; color: var(--accent-color); margin-bottom: 10px; font-weight: bold; min-height: 1.5em; }
    
    /* Syntax Highlighting */
    .kwd { color: #f472b6; }
    .type { color: #60a5fa; }
    .str { color: #ce9178; }
    .com { color: #6a9955; }
    .num { color: #b5cea8; }
    
    @media (max-width: 900px) {
      .visualizer-section { flex-direction: column; }
    }
  </style>
</head>
<body>
  <div class="container">
    <aside class="sidebar">
      <div class="sidebar-header">
        <h1>üåë Amazon SDE</h1>
        <p>Coding Interview Prep</p>
      </div>
      <div class="nav-section">
        <div class="nav-section-title">Back to Home</div>
        <a href="../index.html" class="nav-item">‚Üê Dashboard</a>
      </div>
      <div class="nav-section">
        <div class="nav-section-title">Interactive Visualizers</div>
        <a href="n-queens.html" class="nav-item active">N-Queens Backtracking</a>
      </div>
    </aside>

    <main class="main-content">
      <div class="content-header">
        <h1>‚ôõ N-Queens Backtracking</h1>
        <p>Visualize how the backtracking algorithm places queens on the board.</p>
      </div>

      <div class="section">
        <div class="section-title">üéØ Real-World Scenario: Constraint Satisfaction</div>
        <div class="callout interview-tip">
          <div class="callout-title">Resource Allocation & Scheduling</div>
          <div class="callout-content">
            <p>The N-Queens problem is a classic example of a <strong>Constraint Satisfaction Problem (CSP)</strong>. In real-world systems, this pattern is used for:</p>
            <ul>
              <li><strong>Server Job Scheduling:</strong> Assigning tasks to servers such that no two tasks conflict on shared resources (CPU, Memory, Time slots).</li>
              <li><strong>VLSI Design:</strong> Placing components on a chip so that connecting wires don't overlap or interfere.</li>
              <li><strong>Timetabling:</strong> Creating class schedules where no teacher or student has overlapping classes.</li>
            </ul>
          </div>
        </div>
      </div>

      <div class="section">
        <div class="visualizer-section">
          <!-- Board Visualization (Left) -->
          <div style="flex: 1; display: flex; flex-direction: column; gap: 10px;">
          <div class="controls">
            <button class="tab-btn active" onclick="startViz()" style="border: 1px solid var(--border-color); border-radius: 4px;">‚ñ∂ Start</button>
            <button class="tab-btn" onclick="resetViz()" style="border: 1px solid var(--border-color); border-radius: 4px;">‚Ü∫ Reset</button>
            <span style="color: var(--text-secondary)">Speed:</span>
            <input type="range" min="100" max="1000" value="500" oninput="speed = 1100 - this.value">
          </div>
          <div id="status" class="status-text">Ready to start...</div>

          <!-- Board Visualization Placeholder -->
          <div class="board-view">
            <div class="chess-grid" id="board">
            </div>
          </div>
          </div>

          <!-- Code Tracking Section (Right) -->
          <div class="code-display">
            <div class="lang-tabs">
              <button class="tab-btn active" onclick="switchTab('go', this)">Go</button>
              <button class="tab-btn" onclick="switchTab('java', this)">Java</button>
              <button class="tab-btn" onclick="switchTab('python', this)">Python</button>
            </div>
            
            <div id="code-go" class="code-content" style="display: block;">
<span class="line" id="go-1"><span class="kwd">func</span> solveNQueens(n <span class="type">int</span>) [][]<span class="type">string</span> {</span>
<span class="line" id="go-2">    board := <span class="kwd">make</span>([][]<span class="type">string</span>, n)</span>
<span class="line" id="go-3">    <span class="com">// Initialize board...</span></span>
<span class="line" id="go-4">    <span class="kwd">var</span> res [][]<span class="type">string</span></span>
<span class="line" id="go-5">    backtrack(<span class="num">0</span>, board, &res, n)</span>
<span class="line" id="go-6">    <span class="kwd">return</span> res</span>
<span class="line" id="go-7">}</span>
<span class="line" id="go-8"></span>
<span class="line" id="go-9"><span class="kwd">func</span> backtrack(row <span class="type">int</span>, board [][]<span class="type">string</span>, res *[][]<span class="type">string</span>, n <span class="type">int</span>) {</span>
<span class="line" id="go-10">    <span class="kwd">if</span> row == n {</span>
<span class="line" id="go-11">        <span class="com">// Found solution, add to results</span></span>
<span class="line" id="go-12">        <span class="kwd">return</span></span>
<span class="line" id="go-13">    }</span>
<span class="line" id="go-14">    <span class="kwd">for</span> col := <span class="num">0</span>; col < n; col++ {</span>
<span class="line" id="go-15">        <span class="kwd">if</span> isValid(board, row, col, n) {</span>
<span class="line" id="go-16">            board[row][col] = <span class="str">"Q"</span>  <span class="com">// Place Queen</span></span>
<span class="line" id="go-17">            backtrack(row+<span class="num">1</span>, board, res, n)</span>
<span class="line" id="go-18">            board[row][col] = <span class="str">"."</span>  <span class="com">// Backtrack</span></span>
<span class="line" id="go-19">        }</span>
<span class="line" id="go-20">    }</span>
<span class="line" id="go-21">}</span>
            </div>

            <div id="code-java" class="code-content" style="display: none;">
<span class="line" id="java-1"><span class="kwd">public</span> List&lt;List&lt;String>> solveNQueens(<span class="type">int</span> n) {</span>
<span class="line" id="java-2">    <span class="type">char</span>[][] board = <span class="kwd">new</span> <span class="type">char</span>[n][n];</span>
<span class="line" id="java-3">    <span class="com">// Initialize board...</span></span>
<span class="line" id="java-4">    List&lt;List&lt;String>> res = <span class="kwd">new</span> ArrayList<>();</span>
<span class="line" id="java-5">    backtrack(<span class="num">0</span>, board, res);</span>
<span class="line" id="java-6">    <span class="kwd">return</span> res;</span>
<span class="line" id="java-7">}</span>
<span class="line" id="java-8"></span>
<span class="line" id="java-9"><span class="kwd">void</span> backtrack(<span class="type">int</span> row, <span class="type">char</span>[][] board, List&lt;List&lt;String>> res) {</span>
<span class="line" id="java-10">    <span class="kwd">if</span>(row == board.length) {</span>
<span class="line" id="java-11">        res.add(construct(board));</span>
<span class="line" id="java-12">        <span class="kwd">return</span>;</span>
<span class="line" id="java-13">    }</span>
<span class="line" id="java-14">    <span class="kwd">for</span>(<span class="type">int</span> col = <span class="num">0</span>; col < board.length; col++) {</span>
<span class="line" id="java-15">        <span class="kwd">if</span>(isValid(board, row, col)) {</span>
<span class="line" id="java-16">            board[row][col] = <span class="str">'Q'</span>; <span class="com">// Place Queen</span></span>
<span class="line" id="java-17">            backtrack(row + <span class="num">1</span>, board, res);</span>
<span class="line" id="java-18">            board[row][col] = <span class="str">'.'</span>; <span class="com">// Backtrack</span></span>
<span class="line" id="java-19">        }</span>
<span class="line" id="java-20">    }</span>
<span class="line" id="java-21">}</span>
            </div>

            <div id="code-python" class="code-content" style="display: none;">
<span class="line" id="python-1"><span class="kwd">def</span> solveNQueens(self, n: <span class="type">int</span>) -> List[List[str]]:</span>
<span class="line" id="python-2">    board = [[<span class="str">'.'</span>] * n <span class="kwd">for</span> _ <span class="kwd">in</span> <span class="kwd">range</span>(n)]</span>
<span class="line" id="python-3">    res = []</span>
<span class="line" id="python-4">    </span>
<span class="line" id="python-5">    <span class="kwd">def</span> backtrack(row):</span>
<span class="line" id="python-6">        <span class="kwd">if</span> row == n:</span>
<span class="line" id="python-7">            res.append([<span class="str">""</span>.join(r) <span class="kwd">for</span> r <span class="kwd">in</span> board])</span>
<span class="line" id="python-8">            <span class="kwd">return</span></span>
<span class="line" id="python-9">        </span>
<span class="line" id="python-10">        <span class="kwd">for</span> col <span class="kwd">in</span> <span class="kwd">range</span>(n):</span>
<span class="line" id="python-11">            <span class="kwd">if</span> is_valid(row, col):</span>
<span class="line" id="python-12">                board[row][col] = <span class="str">'Q'</span> <span class="com"># Place Queen</span></span>
<span class="line" id="python-13">                backtrack(row + <span class="num">1</span>)</span>
<span class="line" id="python-14">                board[row][col] = <span class="str">'.'</span> <span class="com"># Backtrack</span></span>
<span class="line" id="python-15">    </span>
<span class="line" id="python-16">    backtrack(<span class="num">0</span>)</span>
<span class="line" id="python-17">    <span class="kwd">return</span> res</span>
            </div>
          </div>
        </div>
      </div>
    </main>
  </div>

  <script>
    let n = 4;
    let speed = 600;
    let isRunning = false;
    let currentLang = 'go';
    let shouldStop = false;

    const lineMap = {
        go: { base: 10, found: 11, loop: 14, check: 15, place: 16, recurse: 17, back: 18 },
        java: { base: 10, found: 11, loop: 14, check: 15, place: 16, recurse: 17, back: 18 },
        python: { base: 6, found: 7, loop: 10, check: 11, place: 12, recurse: 13, back: 14 }
    };

    function initBoard() {
      const board = document.getElementById('board');
      board.innerHTML = '';
      board.style.gridTemplateColumns = `repeat(${n}, 60px)`;
      board.style.gridTemplateRows = `repeat(${n}, 60px)`;

      for (let r = 0; r < n; r++) {
        for (let c = 0; c < n; c++) {
          const cell = document.createElement('div');
          cell.className = `chess-cell ${(r + c) % 2 === 0 ? 'white' : 'black'}`;
          cell.id = `cell-${r}-${c}`;
          board.appendChild(cell);
        }
      }
    }

    function switchTab(lang, btn) {
      currentLang = lang;
      document.querySelectorAll('.code-content').forEach(el => el.style.display = 'none');
      document.getElementById('code-' + lang).style.display = 'block';
      
      document.querySelectorAll('.tab-btn').forEach(el => el.classList.remove('active'));
      if (btn) btn.classList.add('active');
    }

    async function startViz() {
      if (isRunning) return;
      isRunning = true;
      shouldStop = false;
      resetViz(false);
      
      const board = Array(n).fill().map(() => Array(n).fill('.'));
      document.getElementById('status').textContent = "Starting...";
      
      await solve(0, board);
      
      if (!shouldStop) {
        document.getElementById('status').textContent = "Visualization Complete!";
      }
      isRunning = false;
    }

    function resetViz(stop = true) {
      if (stop) {
        shouldStop = true;
        isRunning = false;
      }
      initBoard();
      document.querySelectorAll('.line').forEach(l => l.classList.remove('active'));
      document.getElementById('status').textContent = "Ready";
    }

    async function solve(row, board) {
      if (shouldStop) return false;
      const lines = lineMap[currentLang] || lineMap['go'];

      highlightLine(lines.base);
      if (row === n) {
        highlightLine(lines.found);
        document.getElementById('status').textContent = "Solution Found!";
        await sleep(speed * 2);
        return true; 
      }

      highlightLine(lines.loop);
      for (let col = 0; col < n; col++) {
        if (shouldStop) return false;

        highlightLine(lines.check);
        const cell = document.getElementById(`cell-${row}-${col}`);
        cell.classList.add('checking');
        await sleep(speed / 2);
        cell.classList.remove('checking');

        if (isValid(board, row, col)) {
          board[row][col] = 'Q';
          cell.textContent = '‚ôõ';
          cell.classList.add('queen');
          cell.classList.add('placing');
          
          highlightLine(lines.place);
          document.getElementById('status').textContent = `Placed Queen at (${row}, ${col})`;
          await sleep(speed);
          cell.classList.remove('placing');

          highlightLine(lines.recurse);
          if (await solve(row + 1, board)) return true;

          highlightLine(lines.back);
          board[row][col] = '.';
          cell.textContent = '';
          cell.classList.remove('queen');
          document.getElementById('status').textContent = `Backtracking from (${row}, ${col})`;
          await sleep(speed);
        }
      }
      return false;
    }

    function isValid(board, row, col) {
      for (let i = 0; i < row; i++) {
        if (board[i][col] === 'Q') return false;
        if (col - (row - i) >= 0 && board[i][col - (row - i)] === 'Q') return false;
        if (col + (row - i) < n && board[i][col + (row - i)] === 'Q') return false;
      }
      return true;
    }

    function highlightLine(lineNum) {
      document.querySelectorAll('.line').forEach(l => l.classList.remove('active'));
      const el = document.getElementById(`${currentLang}-${lineNum}`);
      if (el) el.classList.add('active');
    }

    function sleep(ms) {
      return new Promise(resolve => setTimeout(resolve, ms));
    }

    initBoard();
  </script>
  <script src="../script.js"></script>
</body>
</html>